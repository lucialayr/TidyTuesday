legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_x_continuous(name = '', expand = c(0,0)) +
scale_y_continuous(expand = c(0,0)) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = 'bottom',
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
scale_y_continuous(expand = c(0,0), labels = c('spring', 'fall'), breaks = c(90, 8*30+15) +
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_x_continuous(name = '', expand = c(0,0)) +
scale_y_continuous(expand = c(0,0), labels = c('spring', 'fall'), breaks = c(90, 8*30+15)) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = 'bottom',
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_x_continuous(name = '', expand = c(0,0)) +
scale_y_continuous(expand = c(0,0), labels = c('spring', 'fall'), breaks = c(90, 8*30+15)) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = 'bottom',
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
yday('2010-09-15')
yday('2010-03-31')
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_x_continuous(name = '', expand = c(0,0)) +
scale_y_continuous(expand = c(0,0), labels = c('spring', 'fall'), breaks = c(yday('2010-03-31'), yday('2010-09-15'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = 'bottom',
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-09-15'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = 'bottom',
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-09-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = 'bottom',
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-08-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = 'bottom',
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = 'bottom',
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_bw() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
plot.margin = element_blank(),
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year') +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year', breaks = c(1990, 2020)) +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
range(cranes$year)
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year', breaks = c(1995, 2020)) +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year', breaks = c(2000, 2020)) +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year', breaks = c(1995, 2024)) +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year', breaks = c(1994, 2024)) +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = year, color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year', breaks = c(1994, 2024)) +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
plot_data = right_join(cranes, months, by = c("day", "year", "month")) %>%
mutate(observations = replace_na(observations, 0),
observation = if_else(month %in% unique(cranes$month), observations, NA),
season = case_when(month %in% c(3,4,5,6,7,8,9) ~ 'Spring',
month %in% c(10,11,12,1,2) ~ 'Fall')))
plot_data = right_join(cranes, months, by = c("day", "year", "month")) %>%
mutate(observations = replace_na(observations, 0),
observation = if_else(month %in% unique(cranes$month), observations, NA),
season = case_when(month %in% c(3,4,5,6,7,8,9) ~ 'Spring',
month %in% c(10,11,12,1,2) ~ 'Fall'))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = interaction(year, season), color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year', breaks = c(1994, 2024)) +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
plot_data = right_join(cranes, months, by = c("day", "year", "month")) %>%
mutate(observations = replace_na(observations, 0),
observation = if_else(month %in% unique(cranes$month), observations, NA),
season = case_when(month %in% c(3,4) ~ 'Spring',
month %in% c(8, 9, 10) ~ 'Fall'))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = interaction(year, season), color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year', breaks = c(1994, 2024)) +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
plot_data = right_join(cranes, months, by = c("day", "year", "month")) %>%
filter(month %in% unique(cranes$month)) %>%
mutate(observations = replace_na(observations, 0),
observation = if_else(month %in% unique(cranes$month), observations, NA),
season = case_when(month %in% c(3,4) ~ 'Spring',
month %in% c(8, 9, 10) ~ 'Fall'))
ggplot() + coord_polar() + theme_classic() +
geom_smooth(data = plot_data, aes(x = day, y = observations, group = interaction(year, season), color =year),
method = 'loess', se = FALSE, span = 0.2, alpha = 0.8, size = .5) +
scale_y_continuous(name = '', expand = c(0,0)) +
scale_x_continuous(expand = c(0,0), labels = c('Spring', 'Fall'),
breaks = c(yday('2010-03-31'), yday('2010-10-01'))) +
scico::scale_color_scico(palette = 'devon', name = 'Year', breaks = c(1994, 2024)) +
theme(axis.line = element_blank(),
axis.title = element_blank(),
axis.text.x = element_text(size = 12, color = 'white'),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
text = element_text(size = 14, color = 'white'),
legend.position = c(0.5, 0.75),
legend.direction = 'horizontal',
legend.title.position = 'top',
legend.background = element_rect(fill='grey20', color = NA),
legend.box.background = element_rect(fill='grey20', color = NA),
panel.background = element_rect(fill = 'grey20', colour = NA),
plot.background = element_rect(fill = 'grey20', colour = NA),
strip.background = element_rect(fill = 'grey20', color = NA))
